(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{14:function(e,t,s){},16:function(e,t,s){"use strict";s.r(t);var n=s(1),a=s.n(n),r=s(9),o=s.n(r),c=(s(14),s(2)),u=s(3),i=s(5),d=s(4),l=(s(7),s(6)),p=s(0),g=function(e){Object(i.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e))._updatePath=function(e){n.props.updatePath()},n.updateMToken=function(e){console.log("updateMToken"),n.props.updateMessageToken(e)},n.updateSToken=function(e){console.log("updateSToken"),n.props.updateMessageToken(e)},n.updateLState=function(e){console.log("updateLState"),n.props.updateLoggedState(e)},n.submit=function(e,t,s){(null===e||void 0===e||e.length<1||null===t||void 0===t||t.length<1||null===s||void 0===s||s.length<1)&&n.updateLState(!1);var a=new XMLHttpRequest;a.open("POST",e+"/login",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(t){if(4==t.currentTarget.readyState&&201===t.currentTarget.status){var s=JSON.parse(t.currentTarget.responseText),a=s.message_token,r=s.stream_token;console.log("Looking good"),n._updatePath(e),n.updateSToken(r),n.updateMToken(a),n.updateLState(!0)}},a.send("username="+t+"&password="+s),console.log(n.server,n.username,n.password)},n.state={username:"",password:""},console.log("Constrcutor LoginModal"),n.server="",n.username="",n.password="",n.updateMToken=n.props.updateMessageToken.bind(Object(l.a)(n)),n.updateSToken=n.props.updateStreamToken.bind(Object(l.a)(n)),n.updateLState=n.props.updateLoggedState.bind(Object(l.a)(n)),n._updatePath=n.props.updatePath.bind(Object(l.a)(n)),n}return Object(u.a)(s,[{key:"render",value:function(){var e=this;return Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{children:" Login Page"}),Object(p.jsxs)("label",{children:["Server:",Object(p.jsx)("input",{type:"text",name:"server",onChange:function(t){return e.server=t.target.value}})]}),Object(p.jsx)("br",{}),Object(p.jsxs)("label",{children:["username:",Object(p.jsx)("input",{type:"text",name:"username",onChange:function(t){return e.username=t.target.value}})]}),Object(p.jsx)("br",{}),Object(p.jsxs)("label",{children:["password:",Object(p.jsx)("input",{type:"text",name:"password",onChange:function(t){return e.password=t.target.value}})]}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{type:"submit",value:"Submit",onClick:function(t){return e.submit(e.server,e.username,e.password)}})]})}}]),s}(n.Component),j=function(e){Object(i.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(c.a)(this,s),n=t.call(this,e),console.log("USERS CONSTRUCTION"),n}return Object(u.a)(s,[{key:"render",value:function(){var e=this.props.users.map((function(e){return e}));return Object(p.jsxs)("div",{id:"user_list_style",children:[Object(p.jsx)("h3",{children:" User List"}),Object(p.jsx)("ul",{children:e})]})}}]),s}(n.Component),m=function(e){Object(i.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(c.a)(this,s),n=t.call(this,e),console.log("messages CONSTRUCTION"),console.log(n.props.messages),n}return Object(u.a)(s,[{key:"render",value:function(){return Object(p.jsxs)("div",{id:"chat_box_style",children:[Object(p.jsx)("h3",{children:" Message List"}),Object(p.jsx)("ul",{id:"messages",children:this.props.messages})]})}}]),s}(n.Component),h=function(e){Object(i.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e))._updateToken=function(e){n.props.updateMessageToken(e)},n.sendMessage=function(e){if(console.log(e),e){var t=new XMLHttpRequest;t.open("POST",n.props.path+"/message",!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.setRequestHeader("Authorization","Bearer "+n.props.token),t.send("message="+n.message),t.onload=function(){if(201===t.status){var e=t.getResponseHeader("Token");this._updateToken(e),console.log(this.inputReference.current)}else console.log("Something wrong while sending message")}.bind(Object(l.a)(n))}},console.log("COMPOSE CONSTRUCTION"),console.log(n.props.message_token),n._updateToken=n.props.changeToken.bind(Object(l.a)(n)),n.inputReference=a.a.createRef(),n}return Object(u.a)(s,[{key:"render",value:function(){var e=this;return Object(p.jsx)("div",{id:"chat_compose_style",children:Object(p.jsxs)("label",{children:["Send :",Object(p.jsx)("input",{type:"text",name:"compose",ref:this.inputReference,onChange:function(t){return e.message=t.target.value},onKeyUp:function(t){"Enter"!==t.key&&13!==t.keyCode||(e.sendMessage(e.message),t.target.value="")}})]})})}}]),s}(n.Component),b=function(e){Object(i.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e)).date_format=function(e){var t=new Date(1e3*e);return t.toLocaleDateString("en-US")+" "+t.toLocaleTimeString("en-US")},n.updateMessageToken=function(e){n.setState({message_token:e})},n.updateStreamToken=function(e){n.setState({stream_token:e})},n.updateLoggedState=function(e){n.setState({Logged:e}),e&&n.startStream(),console.log("CALLINGG")},n.updateServer=function(e){n.setState({server:e})},n.updatePath=function(e){n.setState({path:e})},n.date_format=function(e){var t=new Date(1e3*e);return t.toLocaleDateString("en-US")+" "+t.toLocaleTimeString("en-US")},n.startStream=function(){n.server=new EventSource(n.state.path+"stream/"+n.state.stream_token),n.server.addEventListener("Users",(function(e){console.log("USERS EVEnt");var t=JSON.parse(e.data);n.setState({users:Array.from(new Set(n.state.users.concat(t.users))).map((function(e){return Object(p.jsx)("li",{children:e})}))})}),!1),n.server.addEventListener("Join",(function(e){console.log("USERS EVEnt");var t=JSON.parse(e.data),s=Object(p.jsxs)("li",{children:[" ",n.date_format(t.created)," Join ",t.user]});n.setState({users:Array.from(new Set(n.state.users.concat(t.user))).map((function(e){return e})),messages:n.state.messages.concat(s)})}),!1),n.server.addEventListener("Part",(function(e){console.log("PART EVENT");var t=JSON.parse(e.data);console.log("Left : "+t.user);var s=n.date_format(t.created)+" Part "+t.user;n.setState({users:n.state.users.filter((function(e){return e!==t.user})).map((function(e){return e})),messages:n.state.messages.concat(s)})}),!1),n.server.addEventListener("Message",(function(e){console.log("Message EVENT");var t=JSON.parse(e.data),s=t.message,a=t.user,r=n.date_format(t.created);console.log("HEY"),console.log(s),console.log(a),console.log(r);var o=Object(p.jsxs)("li",{children:[" ",r," User: ",a," says: ",s]});n.setState({messages:n.state.messages.concat(o)})}),!1),n.server.addEventListener("Disconnect",(function(e){console.log("Message EVENT");e.data;n.setState({messages:[],message_token:"",stream_token:"",path:"",Logged:!1}),n.server.close()}),!1),n.server.addEventListener("ServerStatus",(function(e){console.log("Message EVENT");var t=JSON.parse(e.data),s=Object(p.jsxs)("li",{children:[" ",n.date_format(t.created)," Status ",t.status]});n.setState({messages:n.state.messages.concat(s)})}),!1)},n.date_format=function(e){var t=new Date(1e3*e);return t.toLocaleDateString("en-US")+" "+t.toLocaleTimeString("en-US")},n.state={message_token:"",stream_token:"",path:"",server:null,messages:[],connected:!1,users:[],Logged:!1},n}return Object(u.a)(s,[{key:"render",value:function(){var e="";return e=this.state.Logged?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(j,{users:this.state.users}),Object(p.jsx)(m,{messages:this.state.messages}),Object(p.jsx)(h,{changeToken:this.updateMessageToken,token:this.state.message_token,path:this.state.path})]}):Object(p.jsx)(g,{updateMessageToken:this.updateMessageToken,updateStreamToken:this.updateStreamToken,updateServer:this.updateServer,updateLoggedState:this.updateLoggedState,updatePath:this.updatePath}),Object(p.jsx)("div",{className:"App",children:e})}}]),s}(n.Component),f=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,17)).then((function(t){var s=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;s(e),n(e),a(e),r(e),o(e)}))};o.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(b,{})}),document.getElementById("root")),f()},7:function(e,t,s){}},[[16,1,2]]]);
//# sourceMappingURL=main.55ca6325.chunk.js.map